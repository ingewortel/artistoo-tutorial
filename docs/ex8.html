<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Artistoo tutorial</title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
	<style>
	h2 {
		padding-top: 30px;
	}

	.exercise {
		background-color: #d9f1fa;
		padding : 10px;
		margin-top: 20px;
		margin-bottom: 20px;
	}
	
	.sidebar {
	  position: fixed;
	  top: 0;
	  /* rtl:raw:
	  right: 0;
	  */
	  bottom: 0;
	  /* rtl:remove */
	  left: 0;
	  z-index: 100; /* Behind the navbar */
	  padding: 48px 0 0; /* Height of navbar */
	  box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
	}

	@media (max-width: 767.98px) {
	  .sidebar {
		top: 5rem;
	  }
	}

	.sidebar-sticky {
	  height: calc(100vh - 48px);
	  overflow-x: hidden;
	  overflow-y: auto; /* Scrollable contents if viewport is shorter than content. */
	}

	.sidebar .nav-link {
	  font-weight: 500;
	  color: #333;
	}

	.sidebar .nav-link .feather {
	  margin-right: 4px;
	  color: #727272;
	}

	.sidebar .nav-link.active {
	  color: #2470dc;
	}

	.sidebar .nav-link:hover .feather,
	.sidebar .nav-link.active .feather {
	  color: inherit;
	}

	.sidebar-heading {
	  font-size: .75rem;
	}
	</style>
	
</head>
<body>


<header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
  	<p><br></p>
  <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="navbar-nav">
  </div>
</header>

<div class="container-fluid">
  <div class="row">
    <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
      <div class="position-sticky pt-3 sidebar-sticky">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link" aria-current="page" href="./index.html">
              <span data-feather="home" class="align-text-bottom"></span>
              Intro
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="ex1.html">
              <span data-feather="file" class="align-text-bottom"></span>
              1. HTML and console
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="ex2.html">
              <span data-feather="shopping-cart" class="align-text-bottom"></span>
              2. Simple CPM
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="ex3.html">
              <span data-feather="users" class="align-text-bottom"></span>
              3. Act-CPM
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="ex4.html">
              <span data-feather="bar-chart-2" class="align-text-bottom"></span>
              4. Interactivity
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="ex5.html">
              <span data-feather="layers" class="align-text-bottom"></span>
              5. Visualizations
            </a>
          </li>
           <li class="nav-item">
            <a class="nav-link" href="ex6.html">
              <span data-feather="layers" class="align-text-bottom"></span>
              6. Outputs and plots
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="ex7.html">
              <span data-feather="layers" class="align-text-bottom"></span>
              7. Custom constraint (1)
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="ex8.html">
              <span data-feather="layers" class="align-text-bottom"></span>
              8. Custom constraint (2)
            </a>
          </li>          
        </ul>

        <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted text-uppercase">
          <span>Tips and tricks</span>
          <a class="link-secondary" href="#" aria-label="Add a new report">
            <span data-feather="plus-circle" class="align-text-bottom"></span>
          </a>
        </h6>
        <ul class="nav flex-column mb-2">
          <li class="nav-item">
            <a class="nav-link" href="js-basics.html">
              <span data-feather="file-text" class="align-text-bottom"></span>
              Some JS basics
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="artistoo-howto.html">
              <span data-feather="file-text" class="align-text-bottom"></span>
              "How to" in Artistoo
            </a>
          </li>
         
        </ul>
      </div>
    </nav>

    <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
      <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2">Tutorial: Making interactive CPMs in the browser with Artistoo</h1>
        <div class="btn-toolbar mb-2 mb-md-0">
          <div class="btn-group me-2">
            <button type="button" class="btn btn-sm btn-outline-secondary" onclick="location.href='ex7.html'">Previous</button>
            <!--<button type="button" class="btn btn-sm btn-outline-secondary" onclick="location.href='./ex8.html'">Next</button>-->
          </div>
        </div>
      </div>
      
      <h2>8. More complex constraints</h2>
      <div>
      	
      	<p>The constraint we built in the last two exercises was not yet very 
      	complicated. In some cases, you may want to keep track of certain 
      	variables after every copy attempt or after every MCS. This exercise
      	will show how this works.</p>
            	
      	<h4>Using listeners: postSetpixListener and postMCSListener </h4>
      
      	<p>Please open <code>8-focaladhesions.html</code> in a text editor and your browser. 
      	In the browser, you should see a bunch of Act-cells moving.
      	</p>
      	
      	<p>Now have a look at the code in the text editor, in the class FocalAdhesions.
      	The goal of this constraint is to let protruding cells generate adhesion sites 
      	with some probability p<sub>adh</sub>, and to forbid any retracting copy attempts
      	into cell pixels at or next to such an adhesion (implemented in 
      	<code>fulfilled()</code>). </p>
      	
      	<p>Pay attention to two important functions:
      		<ul>
      			<li><code>postSetpixListener(i, cid_old, cid_new)</code></li>
      			<li><code>postMCSListener()</code></li>
      		</ul>
      		When a constraint is added to the CPM by <code>C.add()</code>, it looks
      		if these two functions are implemented. The CPM then automatically 
      		executes anything in <code>postSetpixListener</code> after every copy 
      		attempt, and anything in <code>postMCSListener</code> after every MCS.
      		Because these are called automatically from within the CPM, they must 
      		always have the same input arguments (<code>i,cid_old,cid_new</code> for 
      		the <code>postSetpixListener</code>, and none for the <code>postMCSListener</code>).
      	</p>
      	
      	
      			
		<p><div class="exercise">
		<b>Exercise</b><br>
		The cells in this simulation already have the new <code>FocalAdhesions</code>
		constraint added, but it does not work yet because the adhesions are never
		generated.		
		<br><br>
		
		Can you implement the <code>postSetpixListener</code> such that it lets new 
		adhesions spawn with probability p<sub>adh</sub> after every copy attempt?
		
		(<i>Hint: also check out the <code>setup()</code> function to see which 
		parameters this constraint gets.</i>)
		</div></p>
		
		<p>Check out <code>8-focaladhesions-answer.html</code> for comparison. </p>
		
		
		
		<h4>Final notes</h4>

		<p>This tutorial has covered most of the basic principles of building 
		interactive CPMs with Artistoo. For further inspiration, have a look at:
		<ul>
			<li>The source code of the constraints that come with the library,
			which you can find <a href="https://artistoo.net/identifiers.html">
			here</a> (look under "Hamiltonian")</li>
			<li>The gallery of <a href="https://artistoo.net/examples.html">examples</a></li>
			<li>The bonus examples in this repository: <code>pseudopods.html</code> 
			(based on <a href="https://www.pnas.org/doi/10.1073/pnas.1208927109">Ariotti et al </a>)
			and <code>active-adhesion.html</code> (based on 
			<a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1009156">Van Steijn et al, 2022</a>.).
		</ul>
		</p>
		
		<p>Good luck!</p>
		
		
      </div>
      

   </main>
  </div>
</div>





</body>
</html>


